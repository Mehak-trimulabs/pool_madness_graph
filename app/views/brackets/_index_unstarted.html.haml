- content_for :title, "My Brackets"

- if @brackets.present?

  .brackets
    .bracket-row.bracket-list-header
      .bracket-attributes
        .position &nbsp;
        .bracket-details
          .name Name
          .final-four-teams
            .final-four-team.final-four-team0 Final
            .final-four-team.final-four-team1 Four
            .final-four-team.final-four-team2 Second
            .final-four-team.final-four-team3 Champion
          .tie-breaker Tie
          .status Status

    - @brackets.each_with_index do |bracket, i|
      =link_to bracket do
        .bracket-row{:id => "bracket-row-#{bracket.id}"}
          .bracket-attributes
            .position &nbsp;
            .bracket-details
              .name= bracket.name
              .final-four-teams
                - bracket.sorted_four.each_with_index do |team, i|
                  %div{class: "final-four-team final-four-team#{i}"}
                    = team.name
                - (4 - bracket.sorted_four.size).times do |i|
                  %div{class: "final-four-team final-four-team#{i + bracket.sorted_four.size}"}
              .tie-breaker= bracket.tie_breaker
              .status= status_to_label(bracket.status)

.actions
  - if can? :create, @pool.brackets.build(user_id: current_user.id)
    - if @brackets.present?
      = link_to "Another Bracket Entry", pool_brackets_path, method: :post, class: [:button, :minor]
    - else
      = link_to "New Bracket Entry", pool_brackets_path, :method => :post, :class => "button"
  - if @unpaid_brackets.present?
    .payment
      = form_tag charges_path, method: :post do
        - @unpaid_brackets.each do |unpaid_bracket|
          = hidden_field_tag "bracket_ids[]", unpaid_bracket.id, id: nil
        %script.stripe-button{"data-amount" => @unpaid_brackets.size * @pool.entry_fee, "data-description" => pluralize(@unpaid_brackets.size, "bracket"), "data-email" => current_user.email, "data-image" => image_path("basketball_icon.png"), "data-key" => Rails.configuration.stripe[:publishable_key], "data-name" => "Pool Madness", "data-allow-remember-me" => "false", :src => "https://checkout.stripe.com/checkout.js"}
